Данный репозиторий содержит мое решение для соревнования Yandex Cup ML 2024.

Участникам предлагалось создать алгоритм, который будет находить вариации и каверы музыкальных произведений, наиболее близкие к оригинальной композиции.  

В качестве данных авторами задачи были предложены сжатые по размерности времени CQT-спектрограммы. Каждая спектрограмма построена по 60 секундам, взятыми из центральной части трека, и имеет итоговую размерность (84, 50).

## Установка
Откройте терминал и выполните:
```
git clone https://github.com/olisvalue/yacup_ml_csi.git
cd yacup_ml_csi
pip install -r requirements.txt
```

## Данные
Все файлы можно загрузить по [ссылке](https://disk.yandex.ru/d/RjMQIusMf6_L4w). Нужно разместить в ```./data```.


## Обучение

Для запуска обучения, выполните:
```
python train.py
```
Для обучения используется конфиг, находящийся здесь: ```./config/config_train.yaml```   

Обратите внимание:   
1. Для обучения только на train-выборке, используйте ```use_val_for_train: False```. Кроме того, поменяйте ```num_classes: 41616``` на ```num_classes: 39535``` в поле ```train```
2. Если система имеет достаточно RAM, для ускорения обучения используйте ```store_data_in_ram: True```  

## Инференс
Для получения ответов модели на тестовой выборке соревнование, выполните:
```
python test.py
```
Для инференса используется конфиг, находящийся здесь: ```./config/config_test.yaml```  

Укажите в поле ```test``` конфигурационного файла правильный путь к чекпоинту модели, которая будет использоваться для инференса.

После выполнения скрипта, файл с ответами будет находиться в ```./outputs_test```